# Course Project: Local DNS Server

## 介绍

*本程序使用C#编写，运行时应当需要.Net环境*

该项目手动在本地模拟了一个DNS服务器，作为本地应用与路由的中转。

在程序中存在两个线程：

- 线程1用以监听本地应用发出的DNS请求，将其拦截并拆分处理，查找缓冲区，如果缓冲区不存在对应的记录则通过发送端转发至网关。
- 线程2用以接受网关发回的DNS响应，拆分处理，加入缓冲区，并通过接收端返回给本地应用。

以下变量均硬编码至程序的DNSServer.cs中，只能在代码中改变以下变量

- DNS默认端口：53

- 发送端端口(Sender Port)：55555

- 缓冲区TTL默认时长(Default TTL)：10秒

- 缓冲区默认大小(Default Cache Size)：3
- 网关(Gateway IP Address)：192.168.1.1

## 准备工作

在运行程序之前，应当修改本机的DNS服务器地址，由自动获得改为手动指定，首选DNS服务器地址为 127.0.0.1，修改完毕后应当在cmd中运行 ipconfig /all 查看本机DNS服务器地址是否改变

查看网关地址，将程序中的GatewayIPAddress改为网关地址，默认为 192.168.1.1

安装.Net运行时环境

## 缺陷

在程序运行中，有可能会出现 ***远程主机强迫关闭了一个现有的连接***，这个错误一般在使用浏览器发送DNS请求时小概率出现且能力有限找不到原因，程序对这个错误进行了catch处理，会将错误信息输出到控制台，但不会终止程序，但代价是该条DNS记录会被丢弃。

在缓冲区因***缓冲区溢出***而移除记录时，由于需要遍历获取HashMap的Key来移除记录，效率可能比较低下
